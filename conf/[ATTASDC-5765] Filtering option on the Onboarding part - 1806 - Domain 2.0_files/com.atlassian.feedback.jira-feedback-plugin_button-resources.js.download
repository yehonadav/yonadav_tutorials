;
/* module-key = 'com.atlassian.feedback.jira-feedback-plugin:button-resources', location = '/js/issue-collector.js' */
define("jira/feedback/issue-collector",["require"],function(require){var jQuery=require("jquery");var Meta=require("jira/util/data/meta");var projectTypeMap={software:"13831",business:"13830",service_desk:"13832",unknown:"13833"};var customFieldMap={page_path:"customfield_16632",project_type_id:"customfield_16630",version:"customfield_10932"};function getProjectTypeFromMeta(){var projectType=Meta.get("issue-project-type");return projectType}function getProjectTypeFromProjectSidebar(){var projectType;try{var projectData=require("jira/api/projects");projectType=projectData.getCurrentProjectType()}catch(ignored){projectType=undefined}return projectType}return{getJiraVersion:function(){var version=Meta.get("version-number");return version?version:"not detected"},getProjectType:function(){var projectType=getProjectTypeFromMeta();if(!projectType||!projectTypeMap[projectType]){projectType=getProjectTypeFromProjectSidebar();if(!projectType||!projectTypeMap[projectType]){projectType="unknown"}}return projectType?projectType:"unknown"},getProjectTypeId:function(){var projectType=this.getProjectType();return projectTypeMap[projectType]?projectTypeMap[projectType]:projectTypeMap.unknown},getPath:function(){return window.location.pathname},getFieldValues:function(){var fieldValues={};fieldValues[customFieldMap.page_path]=this.getPath();fieldValues[customFieldMap.project_type_id]=this.getProjectTypeId(projectTypeMap);fieldValues[customFieldMap.version]=this.getJiraVersion();return fieldValues}}});;
;
/* module-key = 'com.atlassian.feedback.jira-feedback-plugin:button-resources', location = '/js/feedback-dialog.js' */
require(["jquery","jira/loading/loading","underscore","jira/message","jira/ajs/ajax/smart-ajax","wrm/data","jira/feedback/issue-collector"],function(jQuery,LoadingIndicator,_,Messages,SmartAjax,WrmData,IssueCollector){var projectKey={software:"jira.feedback.plugin.issue.collector.software",business:"jira.feedback.plugin.issue.collector.core",service_desk:"jira.feedback.plugin.issue.collector.service.desk",unknown:"jira.feedback.plugin.issue.collector.default"};var loading=false;function initializeIssueCollector(){if(loading){return }loadingStarts();window.ATL_JQ_PAGE_PROPS={triggerFunction:function(showIssueCollectorDialog){_.defer(function(){loadingEnds(true);showIssueCollectorDialog()})},fieldValues:IssueCollector.getFieldValues()};jQuery.ajax({url:feedbackCollectorData[projectKey[IssueCollector.getProjectType()]],type:"get",cache:true,timeout:10000,dataType:"script"}).fail(function(xhr){loadingEnds();Messages.showErrorMsg(SmartAjax.buildSimpleErrorContent(xhr),{closeable:true})})}function loadingStarts(){loading=true;AJS.dim();LoadingIndicator.showLoadingIndicator()}function loadingEnds(success){loading=false;if(success){AJS.dim.$dim.css("transition","none")}AJS.undim();if(success&&AJS.dim.$dim){AJS.dim.$dim.css("transition","")}LoadingIndicator.hideLoadingIndicator()}var feedbackCollectorData=WrmData.claim("com.atlassian.feedback.jira-feedback-plugin:button-resources-init.data");if(feedbackCollectorData&&feedbackCollectorData.isHeaderFeedbackButtonEnabled){jQuery(document).on("click",".jira-feedback-plugin",function(e){e.preventDefault();initializeIssueCollector()})}});;